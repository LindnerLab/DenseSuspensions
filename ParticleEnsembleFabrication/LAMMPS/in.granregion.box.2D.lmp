# pouring spheres into container box

units			lj
atom_style      sphere
boundary        f f p
dimension		2
comm_modify     vel yes

region          box block 0 49.8 0 100  -1 1 units box
create_box      2 box

pair_style		hybrid gran/hooke 40000.0 NULL 100.0 NULL 0 1
pair_coeff		* * gran/hooke

region          container block 0 49.8 0 100 -0.801 0.801 units box
fix				container all wall/gran/region hooke/history &
				40000.0 NULL 100.0 NULL 0 1 region container

neighbor		2 bin
neigh_modify	delay 0 every 1 check yes

fix             2 all nve/sphere
fix				3 all gravity 3.0 vector 0 -1 0

region          slab block 0 49.8 90 100 -0.801 0.801 units box
fix             ins all pour 2000 2 4767548 vol 0.4 10 &
				diam poly 2 1.2 0.5 1.6 0.5 &
				region slab ignore

fix				4 all enforce2d

variable		dt equal "0.1 * 3.1415 * (1/40000)^(1/2)"
print			'Timestep = ${dt}'
timestep		${dt}

compute         1 all temp
compute_modify  1 dynamic/dof yes

compute         2 all temp/sphere
compute_modify  2 dynamic/dof yes

thermo			1000
thermo_style	custom step atoms temp c_1 c_2 press
thermo_modify   lost ignore
compute_modify  thermo_temp dynamic/dof yes

compute			d all property/atom diameter
dump			2 all image 50 V2/image.*.jpg type c_d &
				zoom 1.4 box yes 0.005 axes no 0.9 0.03 size 1024 1024
dump_modify		2 pad 5

dump			3 all custom 5000 V2/dump.*.txt id type x y z diameter
dump_modify		3 pad 5

run				20000

fix				5 all gravity 0.0 vector 0 -1 0
fix				6 all enforce2d

run				5000